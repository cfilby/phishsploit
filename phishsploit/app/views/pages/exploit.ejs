<% include ../template/head %>

<div class="row">
    <div class="card">
      <div class="card-content">
        <span class="card-title grey-text text-darken-4 truncate"><%= exploit.description %></span>

        <div class="row">
          <div class="col s12">
            <ul class="tabs">
              <li class="tab col s3"><a href="#detail" class="active">Detail</a></li>
              <li class="tab col s3"><a href="#info">Info</a></li>
              <li class="tab col s3"><a href="#parts">Key Paths</a></li>
              <li class="tab col s3"><a href="#phish">Phish</a></li>
            </ul>
          </div>

          <div id="detail" class="col s12">
            <div class="card-panel">
              <pre><%= exploitFile.content %></pre>
            </div>
          </div>

          <div id="info" class="col s12">
            <ul class="collection with-header">
              <li class="collection-header"><h5>Exploit Info</h5></li>
              <li class="collection-item">
                <span class="title"><strong>Report Date</strong></span>
                <p><%= new Date(exploit.date).toDateString() %></p>
              </li>

              <li class="collection-item">
                <span class="title"><strong>Author</strong></span>
                <p><%= exploit.author %></p>
              </li>

              <li class="collection-item">
                <span class="title"><strong>Platform</strong></span>
                <p><%= exploit.platform %></p>
              </li>

              <li class="collection-item">
                <span class="title"><strong>Type</strong></span>
                <p><%= exploit.type %></p>
              </li>

              <li class="collection-item">
                <span class="title"><strong>Port</strong></span>
                <p><%= exploit.port %></p>
              </li>
            </ul>
          </div>

          <div id="parts" class="col s12">
            <% if (exploitKeyPaths.length) { %>
              <ul class="collection with-header">
                <li class="collection-header"><h5>Exploit Key Phish Paths</h5></li>
                <% exploitKeyPaths.forEach(function(keyPath) {%>
                  <li class="collection-item">
                    <span class="title"><strong><%= keyPath.pathPart %></strong></span>
                    <p><%= keyPath.description %></p>
                  </li>
                <% }); %>
              </ul>
            <% } else { %>
              <h5 class="center">No Key Paths specified for this exploit.</h5>
            <% } %>
          </div>

          <div id="phish" class="col s12">
            <% if (phish.length) { %>
              <ul class="collection with-header">
                <div class="collection-header"><h5>Some Related Phish</h5></li>
                <% phish.forEach(function(phishEntry) {%>
                  <a href="/phish/specific/<%= phishEntry.phishId %>" class="collection-item truncate"><%= phishEntry.fullUrl %></a>
                <% }); %>
              </div>
            <% } else { %>
              <h5 class="center">No Phish correspond to the Exploit Key Paths.</h5>
            <% } %>
          </div>
        </div>

        <div class="divider"></div>

        <div class="card-action">
          <a href="https://www.exploit-db.com/exploits/<%= exploit.exploitId %>/">ExploitDB Page</a>
        </div>

      </div>
    </div>
</div>

<% include ../template/foot %>
